SELECT "TrainsUK2_1"."Calculation_4220604162631191" AS "Calculation_4220604162631191" FROM "TrainsUK2_1" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date (group)") = (DATE '2015-05-29')) AND ("TrainsUK2_1"."Operator" = 'HY') AND ("TrainsUK2_1"."Calculation_4220604162631191" IS NULL)) LIMIT 1
SELECT "TrainsUK2_1"."Calculation_4220604162631191" AS "Calculation_4220604162631191",   "TrainsUK2_1"."Operator" AS "Operator" FROM "TrainsUK2_1" WHERE (("TrainsUK2_1"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date (group)") = (DATE '2015-05-29'))) AND EXISTS ( SELECT 1 AS "one" FROM (   SELECT "TrainsUK2_1"."Calculation_4220604162631191" AS "Calculation_4220604162631191",     SUM(1) AS "$__alias__0"   FROM "TrainsUK2_1"   WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date (group)") = (DATE '2015-05-29')) AND ("TrainsUK2_1"."Operator" = 'HY'))   GROUP BY 1   ORDER BY "$__alias__0" DESC NULLS LAST   LIMIT 40 ) "t0" WHERE ("TrainsUK2_1"."Calculation_4220604162631191" = "t0"."Calculation_4220604162631191") ) GROUP BY 1,   2
SELECT "TrainsUK2_1"."Calculation_6080608165132814" AS "Calculation_6080608165132814",   "TrainsUK2_1"."Operator" AS "Operator",   "TrainsUK2_1"."c_Origin Time (GBTT) (copy)" AS "c_Origin Time (GBTT) (copy)" FROM "TrainsUK2_1" WHERE (("TrainsUK2_1"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IS NULL))) AND ("TrainsUK2_1"."Calculation_4220604162631191" IN ('1W - London Waterloo to Weymouth', '1W - Weymouth to London Waterloo')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date (group)") = (DATE '2015-05-29'))) GROUP BY 1,   2,   3
SELECT "TrainsUK2_1"."Date (group)" AS "Date (group)" FROM "TrainsUK2_1" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date")) AS BIGINT)) IS NULL)))) GROUP BY 1
SELECT "TrainsUK2_2"."Calculation_4220604162631191" AS "Calculation_4220604162631191" FROM "TrainsUK2_2" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND ("TrainsUK2_2"."Operator" = 'HY')) GROUP BY 1
SELECT "TrainsUK2_2"."Calculation_6080608165132814" AS "Calculation_6080608165132814",   "TrainsUK2_2"."Operator" AS "Operator",   SUM(1) AS "TEMP(Calculation_1160604162544985)(2276395898)(0)",   SUM(CAST("TrainsUK2_2"."v_PPM Pass Flag" AS BIGINT)) AS "TEMP(Calculation_9940604162604158)(493029383)(0)",   SUM(CAST("TrainsUK2_2"."Calculation_2510610113130467" AS BIGINT)) AS "TEMP(c_PPM% (copy))(4237724593)(0)",   "TrainsUK2_2"."c_Origin Time (GBTT) (copy)" AS "c_Origin Time (GBTT) (copy)",   MIN("TrainsUK2_2"."Calculation_5580608170646388") AS "min:Calculation_5580608170646388:nk" FROM "TrainsUK2_2" WHERE (("TrainsUK2_2"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND ("TrainsUK2_2"."Calculation_4220604162631191" IN ('1W - London Waterloo to Weymouth', '1W - Weymouth to London Waterloo')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = (DATE '2015-05-29'))) GROUP BY 1,   2,   6
SELECT "TrainsUK2_2"."Calculation_6080608165132814" AS "Calculation_6080608165132814",   "TrainsUK2_2"."c_Origin Time (GBTT) (copy)" AS "c_Origin Time (GBTT) (copy)",   MIN("TrainsUK2_2"."Calculation_5580608170646388") AS "min:Calculation_5580608170646388:nk" FROM "TrainsUK2_2" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND ("TrainsUK2_2"."Calculation_4220604162631191" IN ('1W - London Waterloo to Weymouth', '1W - Weymouth to London Waterloo')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = (DATE '2015-05-29')) AND ("TrainsUK2_2"."Operator" = 'HY')) GROUP BY 1,   2 HAVING (SUM(1) >= 10)
SELECT "TrainsUK2_2"."Date (group)" AS "Date (group)" FROM "TrainsUK2_2" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL)))) GROUP BY 1
SELECT "TrainsUK2_2"."Date" AS "Date",   SUM(1) AS "TEMP(Calculation_1160604162544985)(2276395898)(0)",   SUM(CAST("TrainsUK2_2"."v_PPM Pass Flag" AS BIGINT)) AS "TEMP(Calculation_9940604162604158)(493029383)(0)",   MIN(TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS "TEMP(attr:Date:ok)(2320508044)(0)",   MIN(TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS "TEMP(attr:Date:ok)(2376345529)(0)",   SUM(CAST("TrainsUK2_2"."Calculation_2510610113130467" AS BIGINT)) AS "TEMP(c_PPM% (copy))(4237724593)(0)" FROM "TrainsUK2_2" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND ("TrainsUK2_2"."Calculation_4220604162631191" IN ('1W - London Waterloo to Weymouth', '1W - Weymouth to London Waterloo')) AND ("TrainsUK2_2"."Operator" = 'HY')) GROUP BY 1
SELECT "TrainsUK2_2"."Operator" AS "Operator" FROM "TrainsUK2_2" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL)))) GROUP BY 1 ORDER BY "Operator" ASC 
SELECT "TrainsUK2_2"."TOC" AS "TOC" FROM "TrainsUK2_2" WHERE ("TrainsUK2_2"."Target Type Name" = 'PPM') GROUP BY 1 ORDER BY "TOC" ASC 
SELECT "TrainsUK2_2"."TOC" AS "TOC" FROM "TrainsUK2_2" WHERE (("TrainsUK2_2"."TOC" = 'HY') AND ("TrainsUK2_2"."Target Type Name" = 'PPM')) GROUP BY 1
SELECT "TrainsUK2_2"."TOC" AS "TOC",   MIN("TrainsUK2_2"."Target Amount Minutes") AS "min:Target Amount Minutes:ok" FROM "TrainsUK2_2" WHERE (("TrainsUK2_2"."TOC" = 'HY') AND ("TrainsUK2_2"."Target Type Name" = 'PPM')) GROUP BY 1
SELECT "t0"."Calculation_4220604162631191" AS "Calculation_4220604162631191",   "t4"."__measure__8" AS "TEMP(Calculation_0800609114850275)(142228831)(0)",   "t0"."__measure__1" AS "TEMP(Calculation_1160604162544985)(2276395898)(0)",   "t0"."TEMP(Calculation_8390609132022332)(3336299537)(0)" AS "TEMP(Calculation_2960611162723805)(3171966951)(0)",   "t0"."TEMP(Calculation_8390609132022332)(3336299537)(0)" AS "TEMP(Calculation_8390609132022332)(3336299537)(0)",   "t0"."ctd:Date:ok" AS "TEMP(Calculation_9810608163756859)(3632339652)(0)",   "t0"."TEMP(Calculation_9940604162604158)(493029383)(0)" AS "TEMP(Calculation_9940604162604158)(493029383)(0)",   "t4"."__measure__9" AS "TEMP(c_Average Distance (Operator) (copy))(4208701958)(0)",   "t0"."TEMP(c_PPM% (copy))(4237724593)(0)" AS "TEMP(c_PPM% (copy))(4237724593)(0)",   "t0"."ctd:Date:ok" AS "ctd:Date:ok" FROM (   SELECT "TrainsUK2_2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",     MEDIAN("TrainsUK2_2"."Planned Total Distance Miles") AS "TEMP(Calculation_8390609132022332)(3336299537)(0)",     SUM(CAST("TrainsUK2_2"."v_PPM Pass Flag" AS BIGINT)) AS "TEMP(Calculation_9940604162604158)(493029383)(0)",     SUM(CAST("TrainsUK2_2"."Calculation_2510610113130467" AS BIGINT)) AS "TEMP(c_PPM% (copy))(4237724593)(0)",     SUM(1) AS "__measure__1",     COUNT(DISTINCT TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS "ctd:Date:ok"   FROM "TrainsUK2_2"   WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = (DATE '2015-05-29')) AND ("TrainsUK2_2"."Operator" = 'HY'))   GROUP BY 1   ORDER BY "__measure__1" DESC NULLS LAST   LIMIT 40 ) "t0"   INNER JOIN (   SELECT "t2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",     MEDIAN("t3"."__measure__3") AS "__measure__8",     MEDIAN("t3"."$temp2") AS "__measure__9"   FROM (     SELECT "TrainsUK2_2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",       "TrainsUK2_2"."Operator" AS "Operator"     FROM "TrainsUK2_2"     WHERE (("TrainsUK2_2"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = (DATE '2015-05-29'))) AND EXISTS (     SELECT 1 AS "one"     FROM (       SELECT "TrainsUK2_2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",         SUM(1) AS "$__alias__0"       FROM "TrainsUK2_2"       WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = (DATE '2015-05-29')) AND ("TrainsUK2_2"."Operator" = 'HY'))       GROUP BY 1       ORDER BY "$__alias__0" DESC NULLS LAST       LIMIT 40     ) "t1"     WHERE ("TrainsUK2_2"."Calculation_4220604162631191" = "t1"."Calculation_4220604162631191")     )     GROUP BY 1,       2   ) "t2"     INNER JOIN (     SELECT "TrainsUK2_2"."Operator" AS "Operator",       MEDIAN("TrainsUK2_2"."Planned Total Distance Miles") AS "__measure__3",       (CAST(SUM(CAST("TrainsUK2_2"."Calculation_2510610113130467" AS BIGINT)) AS double) / NULLIF(SUM(1),0)) AS "$temp2"     FROM "TrainsUK2_2"     WHERE (("TrainsUK2_2"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = (DATE '2015-05-29')))     GROUP BY 1   ) "t3" ON ("t2"."Operator" IS NOT DISTINCT FROM "t3"."Operator")   GROUP BY 1 ) "t4" ON ("t0"."Calculation_4220604162631191" IS NOT DISTINCT FROM "t4"."Calculation_4220604162631191")
SELECT MIN("TrainsUK2_2"."Target Amount Minutes") AS "TEMP(Calculation_8390609132022332)(2549172019)(0)",   "TrainsUK2_2"."TOC" AS "TOC" FROM "TrainsUK2_2" WHERE (("TrainsUK2_2"."TOC" = 'HY') AND ("TrainsUK2_2"."Target Type Name" = 'PPM')) GROUP BY 2
SELECT SUM(1) AS "Calculation_1160604162544985",   "TrainsUK2_2"."Date" AS "Date",   SUM(CAST("TrainsUK2_2"."Calculation_2510610113130467" AS BIGINT)) AS "TEMP(TC_)(4237724593)(0)",   SUM(CAST("TrainsUK2_2"."v_PPM Pass Flag" AS BIGINT)) AS "TEMP(TC_)(493029383)(0)",   MIN(TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS "TEMP(attr:Date:ok)(2320508044)(0)",   MIN(TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS "TEMP(attr:Date:ok)(2376345529)(0)" FROM "TrainsUK2_2" WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= (DATE '2014-04-01')) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= (DATE '2015-05-30')) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS BIGINT)) IS NULL))) AND ("TrainsUK2_2"."Calculation_4220604162631191" IN ('1W - London Waterloo to Weymouth', '1W - Weymouth to London Waterloo')) AND ("TrainsUK2_2"."Operator" = 'HY')) GROUP BY 2
SELECT SUM(CAST("TrainsUK2_2"."Number of Records" AS BIGINT)) AS "sum:Number of Records:ok" FROM "TrainsUK2_2" HAVING (COUNT(1) > 0)
