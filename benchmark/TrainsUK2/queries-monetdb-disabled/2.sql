--SELECT "TrainsUK2_1"."Calculation_4220604162631191" AS "Calculation_4220604162631191",   "TrainsUK2_1"."Operator" AS "Operator" FROM "TrainsUK2_1" WHERE (("TrainsUK2_1"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") >= cast('2014-04-01' as DATE)) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") <= cast('2015-05-30' as DATE)) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date"))) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date"))) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date (group)") = cast('2015-05-29' as DATE))) AND EXISTS ( SELECT 1 AS "one" FROM (   SELECT "TrainsUK2_1"."Calculation_4220604162631191" AS "Calculation_4220604162631191",     SUM(1) AS "$__alias__0"   FROM "TrainsUK2_1"   WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") >= cast('2014-04-01' as DATE)) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date") <= cast('2015-05-30' as DATE)) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date"))) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date"))) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_1"."Date (group)") = cast('2015-05-29' as DATE)) AND ("TrainsUK2_1"."Operator" = 'HY'))   GROUP BY 1   ORDER BY "$__alias__0" DESC   LIMIT 40 ) "t0" WHERE ("TrainsUK2_1"."Calculation_4220604162631191" = "t0"."Calculation_4220604162631191") ) GROUP BY 1,   2;
