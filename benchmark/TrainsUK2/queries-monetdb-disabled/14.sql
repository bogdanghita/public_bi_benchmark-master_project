--SELECT "t0"."Calculation_4220604162631191" AS "Calculation_4220604162631191",   "t4"."__measure__8" AS "TEMP(Calculation_0800609114850275)(142228831)(0)",   "t0"."__measure__1" AS "TEMP(Calculation_1160604162544985)(2276395898)(0)",   "t0"."TEMP(Calculation_8390609132022332)(3336299537)(0)" AS "TEMP(Calculation_2960611162723805)(3171966951)(0)",   "t0"."TEMP(Calculation_8390609132022332)(3336299537)(0)" AS "TEMP(Calculation_8390609132022332)(3336299537)(0)",   "t0"."ctd:Date:ok" AS "TEMP(Calculation_9810608163756859)(3632339652)(0)",   "t0"."TEMP(Calculation_9940604162604158)(493029383)(0)" AS "TEMP(Calculation_9940604162604158)(493029383)(0)",   "t4"."__measure__9" AS "TEMP(c_Average Distance (Operator) (copy))(4208701958)(0)",   "t0"."TEMP(c_PPM% (copy))(4237724593)(0)" AS "TEMP(c_PPM% (copy))(4237724593)(0)",   "t0"."ctd:Date:ok" AS "ctd:Date:ok" FROM (   SELECT "TrainsUK2_2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",     MEDIAN("TrainsUK2_2"."Planned Total Distance Miles") AS "TEMP(Calculation_8390609132022332)(3336299537)(0)",     SUM(CAST("TrainsUK2_2"."v_PPM Pass Flag" AS BIGINT)) AS "TEMP(Calculation_9940604162604158)(493029383)(0)",     SUM(CAST("TrainsUK2_2"."Calculation_2510610113130467" AS BIGINT)) AS "TEMP(c_PPM% (copy))(4237724593)(0)",     SUM(1) AS "__measure__1",     COUNT(DISTINCT TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date")) AS "ctd:Date:ok"   FROM "TrainsUK2_2"   WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= cast('2014-04-01' as DATE)) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= cast('2015-05-30' as DATE)) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = cast('2015-05-29' as DATE)) AND ("TrainsUK2_2"."Operator" = 'HY'))   GROUP BY 1   ORDER BY "__measure__1" DESC   LIMIT 40 ) "t0"   INNER JOIN (   SELECT "t2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",     MEDIAN("t3"."__measure__3") AS "__measure__8",     MEDIAN("t3"."$temp2") AS "__measure__9"   FROM (     SELECT "TrainsUK2_2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",       "TrainsUK2_2"."Operator" AS "Operator"     FROM "TrainsUK2_2"     WHERE (("TrainsUK2_2"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= cast('2014-04-01' as DATE)) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= cast('2015-05-30' as DATE)) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = cast('2015-05-29' as DATE))) AND EXISTS (     SELECT 1 AS "one"     FROM (       SELECT "TrainsUK2_2"."Calculation_4220604162631191" AS "Calculation_4220604162631191",         SUM(1) AS "$__alias__0"       FROM "TrainsUK2_2"       WHERE ((TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= cast('2014-04-01' as DATE)) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= cast('2015-05-30' as DATE)) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = cast('2015-05-29' as DATE)) AND ("TrainsUK2_2"."Operator" = 'HY'))       GROUP BY 1       ORDER BY "$__alias__0" DESC       LIMIT 40     ) "t1"     WHERE ("TrainsUK2_2"."Calculation_4220604162631191" = "t1"."Calculation_4220604162631191")     )     GROUP BY 1,       2   ) "t2"     INNER JOIN (     SELECT "TrainsUK2_2"."Operator" AS "Operator",       MEDIAN("TrainsUK2_2"."Planned Total Distance Miles") AS "__measure__3",       (CAST(SUM(CAST("TrainsUK2_2"."Calculation_2510610113130467" AS BIGINT)) AS double) / NULLIF(SUM(1),0)) AS "$temp2"     FROM "TrainsUK2_2"     WHERE (("TrainsUK2_2"."Operator" = 'HY') AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") >= cast('2014-04-01' as DATE)) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date") <= cast('2015-05-30' as DATE)) AND (NOT (((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IN (1, 7)) OR ((1 + CAST(TRUNC(DATE_PART('DOW', TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date"))) AS BIGINT)) IS NULL))) AND (TABLEAU.NORMALIZE_DATETIME("TrainsUK2_2"."Date (group)") = cast('2015-05-29' as DATE)))     GROUP BY 1   ) "t3" ON (("t2"."Operator" = "t3"."Operator") or ("t2"."Operator" is null and "t3"."Operator" is null))   GROUP BY 1 ) "t4" ON (("t0"."Calculation_4220604162631191" = "t4"."Calculation_4220604162631191") or ("t0"."Calculation_4220604162631191" is null and "t4"."Calculation_4220604162631191" is null));
